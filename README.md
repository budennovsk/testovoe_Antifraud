# Анализ проекта: Модели для детектирования мошенничества

## 1. EDA (Exploratory Data Analysis)

### 1.1 Анализ данных из файла **behavior_task.csv**:
- **Пропуски по фичам (feature_1, feature_19 и т.д.)**: В некоторых признаках количество пропусков составляет больше 50%, но меньше 100%. Эти признаки требуют дополнительного анализа: если они важны с точки зрения корреляции или важности признаков (feature importance), то их следует заполнить. Признаки с 100% пропусками будут удалены.
- **Корреляции**: Для анализа корреляций были выбраны только те признаки, у которых корреляция больше 0.30. Использовался стандартный метод корреляции без учета таргетной переменной. Среди признаков, таких как **feature_0**, наблюдается высокая корреляция с **feature_3**, **feature_31**, **feature_34**, что важно для линейных моделей. Поскольку для дальнейшего анализа будет использоваться бустинг, эти признаки оставлены в модели.
- **Мультиколлинеарность**: Анализ с использованием метода VIF подтвердил результаты, полученные на этапе анализа корреляций.
- **Временной ряд**: Данные относятся к марту 2022 года. При анализе активности пользователей виден явный восходящий тренд в течение месяца, что может быть связано с увеличением объема парсинга данных или экономическими факторами, такими как повышение ключевой ставки Центробанком.

### 2.1 Анализ данных из файла **ki_loans_task.csv**:
- **Рост данных**: Количество строк увеличилось, что связано с добавлением новых данных о кредитной истории (строки с информацией о кредитах).
- **Пропуски**: Пропуски в колонке **CRED_ENDDATE_FACT** составляют 0.13%, что является незначительным.
- **Мультиколлинеарность**: Явных признаков мультиколлинеарности не было обнаружено.
- **Топ-3 кредита по количеству**: Микрозайм, Потребительский кредит, Кредитная карта.
- **Просрочка**: Наибольшие доли просрочек наблюдаются у кредитов с периодом от 3 до 6 месяцев.
- **Кредит на развитие бизнеса** чаще всего имеет просрочку, возможно, это связано с экономическими мерами (например, государственными каникулами).
- **Ипотека** закрывается чаще, чем микрозаймы, а микрозаймы чаще всего просрочены.
- **Сумма задолженности**: Потребительские кредиты занимают лидирующую позицию по общей сумме задолженности, обогнав микрозаймы. Это объясняется тем, что суммы потребительских кредитов значительно выше.
- **Средняя сумма просрочки**: Средняя сумма просрочки по всем кредитам составляет около 20 тыс. рублей.
- **Средняя сумма по ипотечным кредитам**: Средняя сумма по ипотечным кредитам составляет около 2 млн рублей, по микрозаймам — около 50 тыс. рублей, по автокредитам — 500 тыс. рублей.

### 3.1 Анализ данных из файла **profile_task.csv**:
- **Пропуски**: Пропуски составляют 30% по некоторым колонкам, но не более 3% по каждому признаку.
- **Корреляция**: Высокая корреляция наблюдается между признаками **REG_REGION** и **RES_REGION**, что логично и ожидаемо.

### 4.1 Анализ данных из файла **target_task.csv**:
- **Пропуски**: В этом наборе данных пропуски отсутствуют.
- **Дисбаланс классов**: Классы целевой переменной **AF1_TARGET** сильно несбалансированы (78% законопослушных граждан и 22% мошенников).

## Анализ объединенных баз данных:
- **Зарплаты по регионам**: Средняя заработная плата выше всего в Москве и на Ямале, в то время как наименьшие зарплаты фиксируются в Тыве. Это может быть связано с региональными экономическими условиями.
- **Медианные зарплаты**: Медианные значения заработных плат по регионам показали более интересные данные, что может свидетельствовать о несовпадении с официальной статистикой или о возможных искажениях информации при ее предоставлении.
- **Проживание по месту регистрации**: Процент жителей, проживающих по месту постоянной регистрации, ниже всего в кавказских республиках. Это также может быть связано с миграцией и экономическими факторами.
- **Процент мошенников по региону**: Тыва показала высокие показатели среди мошенников, что может быть связано с особенностями социальной и экономической ситуации в регионе.
- **Процент мошенников по IP**: После учета IP-адресов результат изменился, и Тыва перестала быть в топе. В то же время, интересный факт, что процент мошенников также высок в других регионах.
- **Процент мошенников по годам**: Самые высокие показатели мошенничества наблюдаются среди пенсионеров. Это подтверждает гипотезу, что старшее поколение может быть менее осведомлено о современных финансовых рисках.
- **Процент мошенников по типу кредита**: Наибольший процент мошенников наблюдается среди тех, кто оформляет ипотечные кредиты, в то время как микрозаймы показывают минимальные результаты.

## Генерация признаков:
- Для всех временных колонок были созданы дополнительные признаки, такие как год, месяц, день, время. Признаки в виде косинусов и синусов для времени, а также биннинг по возрасту и другие дополнительные признаки не использовались.

## Создание модели:
- **Заполнение пропусков**: Пропуски были заполняты нулями. Это является быстрым решением, но оно негативно сказывается на качестве модели, особенно для признаков с более чем 30% пропусков. В таких случаях было бы полезно использовать более сложные методы заполнения, такие как скользящие средние или использование моделей.
- **Оверсемплинг с использованием SMOTE**: Для устранения дисбаланса классов использовался метод SMOTE на тренировочных данных.
- **Обучение модели**: Модель была обучена с ограничением по числу признаков, чтобы ускорить обучение. Для выбора важнейших признаков можно было бы применить методы рекурсивного исключения признаков (RFE), но в условиях ограниченного времени и ресурсов это было нецелесообразно.
- **Использование GPU**: В дальнейшем можно было бы попробовать ускорить обучение, используя GPU, но в текущем проекте это не было реализовано.
- **Анализ важности признаков**: Признаки, связанные с датами, продемонстрировали значительный вклад в улучшение качества модели. Это может указывать на важность временных аспектов в задаче детектирования мошенничества.
- **Удаление признака ID**: Колонка **ID** была удалена, чтобы избежать ложных выводов, так как она не несет полезной информации для модели.
- **Метрика Logloss**: Обучение проводилось с использованием метрики Logloss, и валидация также использовала эту метрику для дальнейшей калибровки модели, однако в конечном итоге калибровка не была проведена.
- **Уроки из модели**: Модель плохо справляется с обнаружением мошенников, что требует доработки. Важно учитывать, что в задачах антифрода наибольшие потери могут быть связаны с ложными отрицаниями (FN) и ложными положительными результатами (FP), и именно на них нужно фокусироваться для улучшения бизнес-результатов.

## P.S.:
- Не была создана базовая наивная модель, а также не была выполнена доработка признаков и более тщательная работа с пропусками. Дополнительная настройка гиперпараметров могла бы повысить обобщающую способность модели.
- Все эти доработки могли бы значительно улучшить результаты, и в будущем это будет учтено.

## P.P.S.:
- Благодарю за предоставленные данные и возможность работать над этим проектом. Опыт оказался полезным и познавательным.
